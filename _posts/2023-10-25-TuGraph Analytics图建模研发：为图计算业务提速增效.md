---
layout: post
read_time: true
show_date: true
show_author: true
title: "TuGraph Analyticså›¾å»ºæ¨¡ç ”å‘ï¼šä¸ºå›¾è®¡ç®—ä¸šåŠ¡æé€Ÿå¢æ•ˆ"
date: 2023-10-25
tags: [å›¾è®¡ç®—, TuGraph-Analytics, å»ºæ¨¡, æé€Ÿå¢æ•ˆ]
category: opinion
author: TuGraph
description: "TuGraph Analyticså›¾å»ºæ¨¡ç ”å‘ï¼šä¸ºå›¾è®¡ç®—ä¸šåŠ¡æé€Ÿå¢æ•ˆ"
---
ä½œè€…ï¼šTuGraph

## æ¦‚è¿°
GeaFlow Consoleå¹³å°æä¾›äº†å›¾æ•°æ®ç ”å‘èƒ½åŠ›ï¼ŒåŒ…æ‹¬äº†å¯¹ç‚¹ã€è¾¹ã€å›¾ã€è¡¨ã€å‡½æ•°ã€ä»»åŠ¡çš„ç®¡ç†åŠŸèƒ½ï¼Œ ä¸ºäº†è®©ç”¨æˆ·æ›´å¥½çš„ç®¡ç†å…ƒæ•°æ®ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿä¾¿äºç”¨æˆ·å¯¹å›¾è®¡ç®—è¿›ä¸€æ­¥åœ°äº†è§£ã€‚é€šè¿‡å¯¹è¿™äº›ç ”å‘èµ„æºçš„ç®¡ç†ï¼Œç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°ã€ç™½å±åŒ–åœ°åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤è¿™äº›å…ƒæ•°æ®ï¼Œä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿åœ°æŸ¥çœ‹å½“å‰ç§Ÿæˆ·ä¸‹æ‰€æ‹¥æœ‰çš„æ•°æ®èµ„äº§æ¦‚è§ˆåŠè¯¦æƒ…ï¼Œä»è€Œæ›´å¤šå…³æ³¨äºä¸šåŠ¡é€»è¾‘çš„å®ç°ã€‚
## å›¾æ•°æ®ç ”å‘ä»‹ç»
### åŸºæœ¬æ¦‚å¿µ

1. ç‚¹ï¼ˆGeaflowVertexï¼‰ï¼šè¡¨ç¤ºä¸€ä¸ªå¯¹è±¡æˆ–å®ä½“ã€åŒ…å«äº†ç‚¹idï¼Œæ ‡ç­¾å’Œå±æ€§ã€‚
2. è¾¹ï¼ˆGeaflowEdgeï¼‰ï¼šè¡¨ç¤ºå¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œè¿æ¥ç‚¹å’Œç‚¹ï¼ŒåŒ…å«æºç‚¹idï¼Œç›®æ ‡ç‚¹idï¼Œæ ‡ç­¾ï¼Œæ—¶é—´æˆ³å’Œå±æ€§ã€‚
3. å›¾ï¼ˆGeaflowGraphï¼‰ï¼šè¡¨ç¤ºå¯¹è±¡ä¹‹é—´å…³è”å…³ç³»çš„ä¸€ç§æŠ½è±¡æ•°æ®ç»“æ„ï¼Œç”±è‹¥å¹²ä¸ªç‚¹å’Œè‹¥å¹²è¾¹ç»„æˆã€‚
4. è¡¨ï¼ˆGeaflowTableï¼‰:  æ˜¯æœ‰ç»“æ„çš„æ•°æ®çš„é›†ï¼Œç”±è¡Œå’Œåˆ—ç»„æˆï¼Œæ¯åˆ—ä¸ºå­—æ®µï¼Œæœ‰ç›¸åº”çš„ç±»å‹å’Œçº¦æŸæ¡ä»¶ï¼Œæ¯è¡Œä¸ºä¸€æ¡å…·ä½“æ•°æ®ã€‚
5. å‡½æ•°ï¼ˆGeaflowFunctionï¼‰: ç”¨æˆ·è‡ªå®šä¹‰çš„æ–¹æ³•ï¼Œå¯åœ¨dslä½œä¸šä¸­ä½¿ç”¨ã€‚
6. å›¾æ‹“æ‰‘ï¼ˆGeaflowEndpointï¼‰: é€»è¾‘æ¦‚å¿µï¼Œä¸ºä¸€ä¸ªä¸‰å…ƒç»„<edgeId, srcId, targetId>, è¡¨ç¤ºåœ¨ä¸€ä¸ªå›¾ä¸­ï¼Œä¸€ä¸ªè¾¹çš„èµ·ç‚¹å’Œç›®æ ‡ç‚¹çš„çº¦æŸå…³ç³»ã€‚
7. ä»»åŠ¡ï¼ˆGeaflowJobï¼‰: ç ”å‘æ—¶å¯¹è®¡ç®—é€»è¾‘çš„æè¿°ï¼Œç”¨æˆ·é€šè¿‡ç¼–è¾‘ä»»åŠ¡å®ç°ä¸šåŠ¡é€»è¾‘ï¼Œç›®å‰æ”¯æŒdslå’Œé«˜é˜¶ä¸¤ç§æ–¹å¼è¿›è¡Œä»»åŠ¡ç ”å‘:
  1. dslä»»åŠ¡ï¼ˆGeaflowCodeJobï¼‰: é€šè¿‡ç¼–å†™dslä»£ç è¿è¡Œã€‚
  2. é«˜é˜¶ä»»åŠ¡ï¼ˆGeaflowApiJobï¼‰: é€šè¿‡apiçš„æ–¹å¼ï¼Œä½¿ç”¨jaråŒ…è¿è¡Œã€‚
8. ä½œä¸šï¼ˆGeaflowTaskï¼‰: ç”±ä»»åŠ¡ç»è¿‡å‘å¸ƒæµç¨‹ç”Ÿæˆï¼Œæœ€ç»ˆæäº¤è¿è¡Œã€‚ä¸€æ—¦æ„å»ºï¼Œä¸å¯ä¿®æ”¹ä½œä¸šå…ƒä¿¡æ¯(ä¾‹å¦‚ä½œä¸šçš„dslä»£ç æˆ–jaråŒ…)ã€‚
### æ¨¡å‹ç»“æ„

#### ç‚¹&è¾¹&å›¾&è¡¨&å‡½æ•°
![](../../../../assets/images/posts/20231025/tu0.svg)
Geaflowå°†æ‰€æœ‰ç ”å‘èµ„æºè¿›è¡Œäº†ç»“æ„åŒ–çš„æ¨¡å‹è®¾è®¡ï¼Œä»æ¨¡å‹å›¾ä¸­ï¼Œå¯ä»¥çœ‹åˆ°vertexï¼Œedgeï¼Œtableéƒ½ç»§æ‰¿è‡ªGeaflowStructï¼ŒGeaflowStructä¸­åŒ…å«ä¸€ä¸ªGeaflowFieldåˆ—è¡¨ï¼Œå…¶ä¸­GeaflowFieldä»£è¡¨äº†å­—æ®µï¼ŒåŒ…å«ç±»å‹(Longï¼ŒStringï¼ŒBooleanç­‰)å’Œçº¦æŸæ¡ä»¶(ç‚¹idï¼Œå±æ€§ï¼Œè¾¹æºç‚¹idï¼Œè¾¹ç›®æ ‡ç‚¹idç­‰)ã€‚åœ¨å›¾ä¸­ï¼ŒåŒ…å«äº†ç‚¹ã€è¾¹ä»¥åŠEndpointçš„åˆ—è¡¨ï¼Œæè¿°äº†å®ä½“ä¹‹é—´çš„å…³è”ä¿¡æ¯ã€‚
å›¾å’Œè¡¨å…³è”äº†GeaflowPluginConfigï¼Œè¿™æ˜¯æ’ä»¶é…ç½®ï¼Œè¡¨ç¤ºå›¾è¡¨çš„æ¥æºæˆ–è¾“å‡ºé…ç½®ï¼Œä¾‹å¦‚odpsï¼Œslsï¼Œossç­‰ã€‚
å‡½æ•°ä¸­ä¸»è¦åŒ…å«ä¸€ä¸ªjaråŒ…å¯¹è±¡å’Œä¸»ç±»ï¼Œä»¥æ ‡è¯†å‡½æ•°çš„å…¥å£ã€‚

#### ä»»åŠ¡&ä½œä¸š

![](../../../../assets/images/posts/20231025/tu1.svg)
GeaflowJobä¸ºæ‰€æœ‰ä»»åŠ¡ç±»å‹çš„çˆ¶ç±»ï¼Œå…¶ä¸­çš„structsã€graphsã€functionså­—æ®µè®°å½•äº†è¿™ä¸ªä»»åŠ¡æ‰€ä½¿ç”¨çš„å›¾ã€è¡¨ã€å‡½æ•°ï¼Œæ–¹ä¾¿ç”¨æˆ·äº†è§£ä½œä¸šå…³è”çš„ä¸€äº›å…ƒä¿¡æ¯ã€‚ä»»åŠ¡æ ¹æ®ä½¿ç”¨é€”å¾„è¿˜å¯åˆ†ä¸ºä»¥ä¸‹å‡ ç§ç±»å‹:

1. GeaflowProcessJob: åŠ å·¥ä»»åŠ¡ï¼Œç”¨æˆ·ç¼–å†™dslä»£ç å®ç°æ„å›¾æˆ–å›¾è®¡ç®—é€»è¾‘, ä¾‹å¦‚ç¯å½¢è®¡æ•°ã€‚
2. GeaflowIntegrationJob: é›†æˆä»»åŠ¡ï¼Œå¯ä»¥æ ¹æ®æ•°æ®æºè¡¨è‡ªåŠ¨ç”Ÿæˆä»£ç ï¼Œå¯¼å…¥åˆ°å›¾ä¸­ã€‚
3. GeaflowCustomJob: è‡ªå®šä¹‰ä»»åŠ¡ï¼Œ ç”¨æˆ·é€šè¿‡ç¼–å†™é«˜é˜¶apiä»£ç ï¼Œå®ç°å›¾è®¡ç®—é€»è¾‘ï¼Œä¾‹å¦‚å®ç°PageRank, SSSPç­‰ç®—æ³•ã€‚
4. GeaflowStatisticJob: ç»Ÿè®¡ä»»åŠ¡ï¼Œç”¨äºç»Ÿè®¡å›¾çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ç‚¹è¾¹ä¸ªæ•°ã€‚
5. GeaflowServerJob: æŸ¥è¯¢ä»»åŠ¡ï¼Œç”¨äºolapæœåŠ¡ï¼Œæ‰§è¡Œå›¾æŸ¥è¯¢ã€‚

ä»»åŠ¡ï¼ˆGeaflowJobï¼‰å’Œä½œä¸šï¼ˆGeaflowTaskï¼‰é€šè¿‡å‘å¸ƒåŒ…ï¼ˆGeaflowReleaseï¼‰è¿›è¡Œå…³è”ï¼Œä»»åŠ¡ä¸ºç ”å‘æ—¶çš„æè¿°ï¼Œä½œä¸šä¸ºè¿è¡Œæ—¶çš„æè¿°ï¼Œç”¨æˆ·å¯ä»¥å¯¹ä»»åŠ¡è¿›è¡Œå‘å¸ƒï¼Œé€šè¿‡BuildPipelineæ‰§è¡Œæµæ°´çº¿æ„å»ºç”Ÿæˆç›¸åº”çš„å‘å¸ƒåŒ…ï¼Œè¿›è€Œå¾—åˆ°ç›¸åº”çš„ä½œä¸šã€‚Releaseä¸­åŒ…å«äº†ä½œä¸šè¿è¡Œçš„æ‰§è¡Œè®¡åˆ’ã€å¼•æ“ç‰ˆæœ¬ã€ä½œä¸šå‚æ•°ã€é›†ç¾¤å’Œé›†ç¾¤å‚æ•°ç­‰ï¼Œæ˜¯ä½œä¸šåœ¨è¿è¡Œæ—¶æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚ç”¨æˆ·é€šè¿‡åˆ›å»ºå’Œä¿®æ”¹ä»»åŠ¡è¿›è¡Œä¸šåŠ¡é€»è¾‘çš„ç ”å‘ï¼Œé€šè¿‡å‘å¸ƒçš„ä½œä¸šè¿›è¡Œæäº¤è¿è¡Œã€‚

## Demoæ¼”ç¤º

### åˆ›å»ºç‚¹
åœ¨ç ”å‘ç®¡ç†ä¸­æ–°å¢ç‚¹å®šä¹‰, æ¯ä¸ªç‚¹æœ‰å¯¹åº”çš„å­—æ®µåˆ—è¡¨ï¼Œä¸”å¿…é¡»æœ‰ç‚¹idå­—æ®µï¼Œå¦‚ä¸‹ä¾‹å­ä¸­æ–°å¢äº†2ä¸ªç‚¹ï¼špersonå’Œsoftwareã€‚
![](../../../../assets/images/posts/20231025/tu2.png)


![](../../../../assets/images/posts/20231025/tu3.png)

### åˆ›å»ºè¾¹
åœ¨ç ”å‘ç®¡ç†ä¸­æ–°å¢è¾¹å®šä¹‰, æ¯æ¡è¾¹éœ€è¦æœ‰æºç‚¹idå’Œç›®æ ‡ç‚¹idå­—æ®µï¼Œå¦‚ä¸‹ä¾‹å­ä¸­æ–°å¢äº†2æ¡è¾¹ï¼šknowså’Œcreatesã€‚
![](../../../../assets/images/posts/20231025/tu4.png)

### åˆ›å»ºå›¾
åœ¨ç ”å‘ç®¡ç†ä¸­æ–°å¢å›¾å®šä¹‰, å›¾å¯ä»¥å…³è”ä¹‹å‰å®šä¹‰çš„ç‚¹å’Œè¾¹ï¼Œconsoleä¸­é€šè¿‡é€‰æ‹©æ¡†çš„æ–¹å¼è¿›è¡Œå…³è”ã€‚å¦‚ä¸‹ä¾‹å­ä¸­ï¼Œåˆ›å»ºäº†åä¸ºdy_modernçš„å›¾ï¼Œå…¶åŒ…å«äº†personå’Œsoftwareç‚¹ã€createdå’Œknowsè¾¹ã€‚åŒæ—¶ï¼Œå¯ä»¥ä¸ºå›¾é…ç½®æ‹“æ‰‘çº¦æŸï¼Œé™åˆ¶æ­¤å›¾ä¸Šè¾¹çš„æºç‚¹ç›®æ ‡ç‚¹çš„ç»‘å®šå…³ç³»ï¼Œä¾‹å¦‚createè¾¹åªèƒ½æ˜¯person->software, knowè¾¹åªèƒ½æ˜¯person->personï¼ˆEndpointå…·ä½“ä½œç”¨å°†åœ¨åç»­æ–‡ç« ä¸­ä»‹ç»ï¼‰ã€‚
![](../../../../assets/images/posts/20231025/tu6.png)

### åˆ›å»ºè¡¨
åœ¨ç ”å‘ç®¡ç†ä¸­æ–°å¢è¡¨å®šä¹‰ï¼Œ æ­¤ä¾‹å­ä¸­åˆ›å»ºäº†ä¸€ä¸ªè¾“å‡ºè¡¨ï¼Œä¸ºæœ€ç»ˆç»“æœè¾“å‡ºçš„è½½ä½“ï¼Œæœ‰2ä¸ªå­—æ®µpersonåå­—å’Œsoftwareåå­—ã€‚å…¶å‚æ•°é…ç½®ä¸­çš„ç±»å‹ä¸ºfileï¼Œè¡¨ç¤ºè¾“å‡ºåˆ°æœ¬åœ°æ–‡ä»¶ç›®å½•(ä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–ç±»å‹ï¼Œä¾‹å¦‚kafkaï¼Œhive)ã€‚
![](../../../../assets/images/posts/20231025/tu7.png)


![](../../../../assets/images/posts/20231025/tu8.png)

### åˆ›å»ºä»»åŠ¡
æœ¬ç¤ºä¾‹ä¸­ï¼Œæ„é€ å¦‚ä¸‹å…³ç³»å›¾:
![](../../../../assets/images/posts/20231025/tu9.jpg)

ä»»åŠ¡dslå¦‚ä¸‹ï¼Œå…ˆå‘å›¾dy_modernä¸­æ’å…¥ç‚¹è¾¹æ•°æ®ï¼Œç„¶åæ‰§è¡ŒMATCHéå†å›¾ï¼Œæ‰¾åˆ°id=1çš„äººï¼ˆjimï¼‰è®¤è¯†çš„äººï¼ˆkateã€tomï¼‰æ‰€åˆ›å»ºçš„è½¯ä»¶ï¼ˆsoftware1ã€software2ï¼‰ï¼Œæœ€åå°†ç»“æœæ’å…¥åˆ°tbl_resultè¡¨ï¼ˆæ–‡ä»¶ï¼‰ä¸­ã€‚
```sql
USE GRAPH dy_modern;

INSERT INTO dy_modern.person(id, name, age)
SELECT 1, 'jim', 20
UNION ALL
SELECT 2, 'kate', 22
UNION ALL
SELECT 3, 'tom', 24
;

INSERT INTO dy_modern.software(id, name, lang)
SELECT 4, 'software1', 'java'
UNION ALL
SELECT 5, 'software2', 'java'
;

INSERT INTO dy_modern.knows
SELECT 1,2 ,0.2
UNION ALL
SELECT 1,3 ,0.3
;

INSERT INTO dy_modern.creates
SELECT 2, 4, 0.6
UNION ALL
SELECT 3, 5, 0.8
;

INSERT INTO tbl_result
SELECT
	b_name,
    c_name
FROM (
  MATCH (a:person where id = 1) -[e:knows]->(b:person)-[e2:creates]-> (c:software)
  RETURN b.name as b_name, c.name as c_name
)
```
![](../../../../assets/images/posts/20231025/tu10.png)

ä»»åŠ¡å‘å¸ƒä¹‹åå³å¯ç”Ÿæˆå¯¹åº”taskï¼Œè¿›å…¥ä½œä¸šè¯¦æƒ…ç•Œé¢ï¼Œæäº¤ä½œä¸šä¹‹åå¼€å§‹æ‰§è¡Œï¼Œæœ€ç»ˆè¿è¡Œå®Œæˆã€‚
![](../../../../assets/images/posts/20231025/tu11.png)

ä½œä¸šçš„å‚æ•°é…ç½®å¦‚ä¸‹, **æ³¨æ„workeræ•°éœ€è¦è®¾ç½®**:
![](../../../../assets/images/posts/20231025/tu12.png)


![](../../../../assets/images/posts/20231025/tu13.png)

åœ¨å®¹å™¨çš„/tmp/resultç›®å½•ä¸­æ‰¾åˆ°ç»“æœæ–‡ä»¶ã€‚
```console
[root@09db8348371a tmp]# cd /tmp/result/
.partiton_0.crc  .partiton_1.crc  partiton_0  partiton_1
```
ç”±äºgraphä¸­çš„shradCountè®¾ç½®çš„ä¸º2ï¼Œæ‰€ä»¥ç»“æœæ–‡ä»¶æœ‰2ä¸ªåˆ†ç‰‡ï¼špartition_0, partition_1
æŸ¥çœ‹æ–‡ä»¶ï¼Œæœ‰2æ¡æ•°æ®ï¼Œç¬¦åˆç»“æœã€‚

```txt
kate,software1
tom, software2
```


**è‡³æ­¤ï¼Œæˆ‘ä»¬å°±æˆåŠŸä½¿ç”¨å¹³å°çš„å›¾ç ”å‘åŠŸèƒ½å®Œæˆäº†å›¾è¡¨çš„åˆ›å»ºå’Œè®¡ç®—ä½œä¸šçš„è¿è¡Œï¼æ˜¯ä¸æ˜¯è¶…ç®€å•ï¼å¿«æ¥è¯•ä¸€è¯•å§ï¼**

------------------------

GeaFlow(å“ç‰ŒåTuGraph-Analytics) å·²æ­£å¼å¼€æºï¼Œæ¬¢è¿å¤§å®¶å…³æ³¨ï¼ï¼ï¼

æ¬¢è¿ç»™æˆ‘ä»¬ Star å“¦!

Welcome to give us a Star!

GitHubğŸ‘‰[https://github.com/TuGraph-family/tugraph-analytics](https://github.com/TuGraph-family/tugraph-analytics)

## å¾®ä¿¡ç¾¤
![image](../../../../assets/images/wechat.png)

è¯·ç‚¹å‡»é¡¹ç›®é“¾æ¥ä¸‹æ–¹å¾®ä¿¡äºŒç»´ç æ·»åŠ å¾®ä¿¡ç”¨æˆ·ç¾¤ï¼š[https://github.com/TuGraph-family/tugraph-analytics](https://github.com/TuGraph-family/tugraph-analytics)
